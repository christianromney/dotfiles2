"use strict";var V=Object.defineProperty;var ne=Object.getOwnPropertyDescriptor;var ie=Object.getOwnPropertyNames;var se=Object.prototype.hasOwnProperty;var ae=(e,t)=>{for(var o in t)V(e,o,{get:t[o],enumerable:!0})},me=(e,t,o,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of ie(t))!se.call(e,a)&&a!==o&&V(e,a,{get:()=>t[a],enumerable:!(n=ne(t,a))||n.enumerable});return e};var le=e=>me(V({},"__esModule",{value:!0}),e);var ue={};ae(ue,{default:()=>re});module.exports=le(ue);var s=require("@raycast/api"),oe=require("react");var Z=require("@raycast/api"),A=require("react");var l=require("@raycast/api"),v=require("child_process"),j=require("crypto"),u=require("fs"),Y=require("path");var P=e=>{let t=Math.floor(e/3600),o=String(Math.floor(e%3600/60)).padStart(2,"0"),n=String(Math.floor(e%60)).padStart(2,"0");return`${t}:${o}:${n}`};var U=e=>(e.d1=e.d1=="----"?void 0:e.d1,e.d2=e.d2=="----"?void 0:e.d2,Math.round((e.d1?new Date(e.d1):new Date).getTime()-(e.d2?new Date(e.d2):new Date).getTime())/1e3);var N=l.environment.supportPath+"/customTimers.json",O=(e=!1)=>{let t=(0,l.getPreferenceValues)();if(parseFloat(t.volumeSetting)>5){let o="\u26A0\uFE0F Timer alert volume should not be louder than 5 (it can get quite loud!)";return e?(0,l.showHUD)(o):(0,l.showToast)({style:l.Toast.Style.Failure,title:o}),!1}return!0};async function E(e,t="Untitled",o="default"){let a=(l.environment.supportPath+"/"+new Date().toISOString()+"---"+e+".timer").replace(/:/g,"__");(0,u.writeFileSync)(a,t);let p=(0,l.getPreferenceValues)(),f=`${l.environment.assetsPath+"/"+(o==="default"?p.selectedSound:o)}`,h=[`sleep ${e}`];h.push(`if [ -f "${a}" ]; then osascript -e 'display notification "Timer \\"${t}\\" complete" with title "Ding!"'`);let C=`afplay "${f}" --volume ${p.volumeSetting.replace(",",".")}`;if(p.selectedSound==="speak_timer_name"?h.push(`say "${t}"`):h.push(C),p.ringContinuously){let i=`${a}`.replace(".timer",".dismiss");(0,u.writeFileSync)(i,".dismiss file for Timers"),h.push(`while [ -f "${i}" ]; do ${C}; done`)}h.push(`rm "${a}"; else echo "Timer deleted"; fi`),(0,v.exec)(h.join(" && "),(i,y)=>{if(i){console.log(`error: ${i.message}`);return}if(y){console.log(`stderr: ${y}`);return}}),(0,l.popToRoot)(),await(0,l.showHUD)(`Timer "${t}" started for ${P(e)}! \u{1F389}`)}function q(e){let t=`if [ -f "${e}" ]; then rm "${e}"; else echo "Timer deleted"; fi`,o=e.replace(".timer",".dismiss"),n=`if [ -f "${o}" ]; then rm "${o}"; else echo "Timer deleted"; fi`;(0,v.execSync)(t),(0,v.execSync)(n)}function z(){let e=[];return(0,u.readdirSync)(l.environment.supportPath).forEach(o=>{if((0,Y.extname)(o)==".timer"){let n={name:"",secondsSet:-99,timeLeft:-99,originalFile:o};n.name=(0,u.readFileSync)(l.environment.supportPath+"/"+o).toString();let a=o.split("---");n.secondsSet=Number(a[1].split(".")[0]);let p=a[0].replace(/__/g,":");n.timeLeft=Math.max(0,Math.round(n.secondsSet-U({d2:p}))),e.push(n)}}),e.sort((o,n)=>o.timeLeft-n.timeLeft),e}function G(e,t){let o=l.environment.supportPath+"/"+e;(0,u.writeFileSync)(o,t)}function b(){(0,u.existsSync)(N)||(0,u.writeFileSync)(N,JSON.stringify({}))}function I(e){b();let t=JSON.parse((0,u.readFileSync)(N,"utf8"));t[(0,j.randomUUID)()]=e,(0,u.writeFileSync)(N,JSON.stringify(t))}function K(){return b(),JSON.parse((0,u.readFileSync)(N,"utf8"))}function Q(e,t){b();let o=JSON.parse((0,u.readFileSync)(N,"utf8"));o[e].name=t,(0,u.writeFileSync)(N,JSON.stringify(o))}function X(e){b();let t=JSON.parse((0,u.readFileSync)(N,"utf8"));delete t[e],(0,u.writeFileSync)(N,JSON.stringify(t))}function H(){let[e,t]=(0,A.useState)(void 0),[o,n]=(0,A.useState)({}),[a,p]=(0,A.useState)(e===void 0),f=()=>{b();let d=z();t(d);let g=K();n(g),p(!1)};return{timers:e,customTimers:o,isLoading:a,refreshTimers:f,handleStartTimer:(d,g,B=!1)=>{!O(B)||(E(d,g),f())},handleStopTimer:d=>{t(e?.filter(g=>g.originalFile!==d.originalFile)),q(`${Z.environment.supportPath}/${d.originalFile}`),f()},handleStartCT:(d,g=!1)=>{!O(g)||(E(d.timeInSeconds,d.name,d.selectedSound),f())},handleCreateCT:d=>{let g={name:d.name,timeInSeconds:d.secondsSet,selectedSound:"default"};I(g),f()},handleDeleteCT:d=>{X(d),f()}}}var S=require("@raycast/api");var k=require("@raycast/api");var D=require("fs");var $=k.environment.supportPath+"/raycast-stopwatches.json",ce=()=>{(0,D.existsSync)($)||(0,D.writeFileSync)($,JSON.stringify([]))};var ee=(e,t)=>{ce();let n=JSON.parse((0,D.readFileSync)($,"utf8")).map(a=>a.swID==e?{...a,name:t}:a);(0,D.writeFileSync)($,JSON.stringify(n))};var J=require("react/jsx-runtime");function M(e){let t=o=>{if(o===""||o===e.currentName)new S.Toast({style:S.Toast.Style.Failure,title:"No new name given!"}).show();else{switch((0,S.popToRoot)(),e.originalFile){case"customTimer":Q(e.ctID?e.ctID:"-99",o);break;case"stopwatch":ee(e.ctID?e.ctID:"-99",o);break;default:G(e.originalFile,o);break}new S.Toast({style:S.Toast.Style.Success,title:`Renamed to ${o}!`}).show()}};return(0,J.jsx)(S.Form,{actions:(0,J.jsx)(S.ActionPanel,{children:(0,J.jsx)(S.Action.SubmitForm,{title:"Rename",onSubmit:o=>t(o.newName)})}),children:(0,J.jsx)(S.Form.TextField,{id:"newName",title:"New name",placeholder:e.currentName})})}var c=require("@raycast/api"),R=require("react");var F=require("@raycast/api"),te=[{title:"Alarm Clock",icon:F.Icon.Alarm,value:"alarmClock.wav"},{title:"Dismembered Woodpecker",icon:F.Icon.Bird,value:"dismemberedWoodpecker.wav"},{title:"Flute Riff",icon:F.Icon.Music,value:"fluteRiff.wav"},{title:"Level Up",icon:F.Icon.Trophy,value:"levelUp.wav"},{title:"Piano Chime",icon:F.Icon.Music,value:"pianoChime.wav"},{title:"Terminator",icon:F.Icon.BarCode,value:"terminator.wav"},{title:"Speak Timer Name",icon:F.Icon.Person,value:"speak_timer_name"}];var w=require("react/jsx-runtime");function _(e){let t=Object.values(e.arguments).some(r=>r!==""),[o,n]=(0,R.useState)(),[a,p]=(0,R.useState)(),[f,h]=(0,R.useState)(),C=r=>{if(b(),r.hours===""&&r.minutes===""&&r.seconds==="")new c.Toast({style:c.Toast.Style.Failure,title:"No values set for timer length!"}).show();else if(isNaN(Number(r.hours)))n("Hours must be a number!");else if(isNaN(Number(r.minutes)))p("Minutes must be a number!");else if(isNaN(Number(r.seconds)))h("Seconds must be a number!");else{if(!O())return;(0,c.closeMainWindow)();let T=r.name?r.name:"Untitled",W=3600*Number(r.hours)+60*Number(r.minutes)+Number(r.seconds);E(W,T,r.selectedSound),r.willBeSaved&&I({name:r.name,timeInSeconds:W,selectedSound:r.selectedSound})}},i=()=>{o&&o.length>0&&n(void 0)},y=()=>{a&&a.length>0&&p(void 0)},x=()=>{f&&f.length>0&&h(void 0)},L=[{id:"hours",title:"Hours",placeholder:"0",err:o,drop:i,validator:r=>{let T=r.target.value;isNaN(Number(T))?n("Hours must be a number!"):i()}},{id:"minutes",title:"Minutes",placeholder:"00",err:a,drop:y,validator:r=>{let T=r.target.value;isNaN(Number(T))?p("Minutes must be a number!"):y()}},{id:"seconds",title:"Seconds",placeholder:"00",err:f,drop:x,validator:r=>{let T=r.target.value;isNaN(Number(T))?h("Seconds must be a number!"):x()}}];return(0,c.getPreferenceValues)().newTimerInputOrder!=="hhmmss"&&L.reverse(),(0,w.jsxs)(c.Form,{actions:(0,w.jsx)(c.ActionPanel,{children:(0,w.jsx)(c.Action.SubmitForm,{title:"Start Custom Timer",onSubmit:r=>C(r)})}),children:[L.map((r,T)=>(0,w.jsx)(c.Form.TextField,{id:r.id,title:r.title,placeholder:r.placeholder,defaultValue:e.arguments[r.id],error:r.err,onChange:r.drop,onBlur:r.validator},T)),(0,w.jsxs)(c.Form.Dropdown,{id:"selectedSound",defaultValue:"default",title:"Sound",children:[(0,w.jsx)(c.Form.Dropdown.Item,{value:"default",title:"Default"}),te.map((r,T)=>(0,w.jsx)(c.Form.Dropdown.Item,{title:r.title,value:r.value,icon:r.icon},T))]}),(0,w.jsx)(c.Form.TextField,{id:"name",title:"Name",placeholder:"Pour Tea",autoFocus:t}),(0,w.jsx)(c.Form.Checkbox,{id:"willBeSaved",label:"Save as preset"})]})}var m=require("react/jsx-runtime");function re(){let{timers:e,customTimers:t,isLoading:o,refreshTimers:n,handleStopTimer:a,handleStartCT:p,handleCreateCT:f,handleDeleteCT:h}=H(),{push:C}=(0,s.useNavigation)();return(0,oe.useEffect)(()=>{n(),setInterval(()=>{n()},1e3)},[]),(0,m.jsxs)(s.List,{isLoading:o,children:[(0,m.jsxs)(s.List.Section,{title:e?.length!==0&&e!=null?"Currently Running":"No Timers Running",children:[e?.map(i=>(0,m.jsx)(s.List.Item,{icon:{source:s.Icon.Clock,tintColor:s.Color.Yellow},title:i.name,subtitle:P(i.timeLeft)+" left",accessories:[{text:P(i.secondsSet)+" originally"}],actions:(0,m.jsxs)(s.ActionPanel,{children:[(0,m.jsx)(s.Action,{title:"Stop Timer",onAction:()=>a(i)}),(0,m.jsx)(s.Action,{title:"Rename Timer",onAction:()=>C((0,m.jsx)(M,{currentName:i.name,originalFile:i.originalFile,ctID:null}))}),(0,m.jsx)(s.Action,{title:"Save Timer as Preset",shortcut:{modifiers:["cmd","shift"],key:"enter"},onAction:()=>f(i)})]})},i.originalFile)),(0,m.jsx)(s.List.Item,{icon:s.Icon.Clock,title:"Create a new timer",subtitle:"Press Enter to start a timer",actions:(0,m.jsx)(s.ActionPanel,{children:(0,m.jsx)(s.Action,{title:"Start Timer",onAction:()=>C((0,m.jsx)(_,{arguments:{hours:"",minutes:"",seconds:""}}))})})},0)]}),(0,m.jsx)(s.List.Section,{title:"Custom Timers",children:Object.keys(t)?.sort((i,y)=>t[i].timeInSeconds-t[y].timeInSeconds).map(i=>(0,m.jsx)(s.List.Item,{icon:s.Icon.Clock,title:t[i].name,subtitle:P(t[i].timeInSeconds),actions:(0,m.jsxs)(s.ActionPanel,{children:[(0,m.jsx)(s.Action,{title:"Start Timer",onAction:()=>p(t[i])}),(0,m.jsx)(s.Action,{title:"Rename Timer",onAction:()=>C((0,m.jsx)(M,{currentName:t[i].name,originalFile:"customTimer",ctID:i}))}),(0,m.jsx)(s.Action,{title:"Delete Custom Timer",shortcut:{modifiers:["ctrl"],key:"x"},onAction:()=>h(i)})]})},i))})]})}0&&(module.exports={});

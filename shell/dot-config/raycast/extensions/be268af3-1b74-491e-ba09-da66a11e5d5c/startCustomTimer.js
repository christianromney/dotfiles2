"use strict";var w=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var I=Object.prototype.hasOwnProperty;var k=(r,t)=>{for(var n in t)w(r,n,{get:t[n],enumerable:!0})},H=(r,t,n,d)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of A(t))!I.call(r,s)&&s!==n&&w(r,s,{get:()=>t[s],enumerable:!(d=x(t,s))||d.enumerable});return r};var J=r=>H(w({},"__esModule",{value:!0}),r);var _={};k(_,{default:()=>V});module.exports=J(_);var o=require("@raycast/api"),N=require("react");var p=require("@raycast/api"),$=[{title:"Alarm Clock",icon:p.Icon.Alarm,value:"alarmClock.wav"},{title:"Dismembered Woodpecker",icon:p.Icon.Bird,value:"dismemberedWoodpecker.wav"},{title:"Flute Riff",icon:p.Icon.Music,value:"fluteRiff.wav"},{title:"Level Up",icon:p.Icon.Trophy,value:"levelUp.wav"},{title:"Piano Chime",icon:p.Icon.Music,value:"pianoChime.wav"},{title:"Terminator",icon:p.Icon.BarCode,value:"terminator.wav"},{title:"Speak Timer Name",icon:p.Icon.Person,value:"speak_timer_name"}];var i=require("@raycast/api"),v=require("child_process"),P=require("crypto"),u=require("fs");var C=r=>{let t=Math.floor(r/3600),n=String(Math.floor(r%3600/60)).padStart(2,"0"),d=String(Math.floor(r%60)).padStart(2,"0");return`${t}:${n}:${d}`};var T=i.environment.supportPath+"/customTimers.json",M=(r=!1)=>{let t=(0,i.getPreferenceValues)();if(parseFloat(t.volumeSetting)>5){let n="\u26A0\uFE0F Timer alert volume should not be louder than 5 (it can get quite loud!)";return r?(0,i.showHUD)(n):(0,i.showToast)({style:i.Toast.Style.Failure,title:n}),!1}return!0};async function E(r,t="Untitled",n="default"){let s=(i.environment.supportPath+"/"+new Date().toISOString()+"---"+r+".timer").replace(/:/g,"__");(0,u.writeFileSync)(s,t);let c=(0,i.getPreferenceValues)(),h=`${i.environment.assetsPath+"/"+(n==="default"?c.selectedSound:n)}`,m=[`sleep ${r}`];m.push(`if [ -f "${s}" ]; then osascript -e 'display notification "Timer \\"${t}\\" complete" with title "Ding!"'`);let g=`afplay "${h}" --volume ${c.volumeSetting.replace(",",".")}`;if(c.selectedSound==="speak_timer_name"?m.push(`say "${t}"`):m.push(g),c.ringContinuously){let f=`${s}`.replace(".timer",".dismiss");(0,u.writeFileSync)(f,".dismiss file for Timers"),m.push(`while [ -f "${f}" ]; do ${g}; done`)}m.push(`rm "${s}"; else echo "Timer deleted"; fi`),(0,v.exec)(m.join(" && "),(f,S)=>{if(f){console.log(`error: ${f.message}`);return}if(S){console.log(`stderr: ${S}`);return}}),(0,i.popToRoot)(),await(0,i.showHUD)(`Timer "${t}" started for ${C(r)}! \u{1F389}`)}function D(){(0,u.existsSync)(T)||(0,u.writeFileSync)(T,JSON.stringify({}))}function O(r){D();let t=JSON.parse((0,u.readFileSync)(T,"utf8"));t[(0,P.randomUUID)()]=r,(0,u.writeFileSync)(T,JSON.stringify(t))}var l=require("react/jsx-runtime");function V(r){let t=Object.values(r.arguments).some(e=>e!==""),[n,d]=(0,N.useState)(),[s,c]=(0,N.useState)(),[h,m]=(0,N.useState)(),g=e=>{if(D(),e.hours===""&&e.minutes===""&&e.seconds==="")new o.Toast({style:o.Toast.Style.Failure,title:"No values set for timer length!"}).show();else if(isNaN(Number(e.hours)))d("Hours must be a number!");else if(isNaN(Number(e.minutes)))c("Minutes must be a number!");else if(isNaN(Number(e.seconds)))m("Seconds must be a number!");else{if(!M())return;(0,o.closeMainWindow)();let a=e.name?e.name:"Untitled",F=3600*Number(e.hours)+60*Number(e.minutes)+Number(e.seconds);E(F,a,e.selectedSound),e.willBeSaved&&O({name:e.name,timeInSeconds:F,selectedSound:e.selectedSound})}},f=()=>{n&&n.length>0&&d(void 0)},S=()=>{s&&s.length>0&&c(void 0)},y=()=>{h&&h.length>0&&m(void 0)},b=[{id:"hours",title:"Hours",placeholder:"0",err:n,drop:f,validator:e=>{let a=e.target.value;isNaN(Number(a))?d("Hours must be a number!"):f()}},{id:"minutes",title:"Minutes",placeholder:"00",err:s,drop:S,validator:e=>{let a=e.target.value;isNaN(Number(a))?c("Minutes must be a number!"):S()}},{id:"seconds",title:"Seconds",placeholder:"00",err:h,drop:y,validator:e=>{let a=e.target.value;isNaN(Number(a))?m("Seconds must be a number!"):y()}}];return(0,o.getPreferenceValues)().newTimerInputOrder!=="hhmmss"&&b.reverse(),(0,l.jsxs)(o.Form,{actions:(0,l.jsx)(o.ActionPanel,{children:(0,l.jsx)(o.Action.SubmitForm,{title:"Start Custom Timer",onSubmit:e=>g(e)})}),children:[b.map((e,a)=>(0,l.jsx)(o.Form.TextField,{id:e.id,title:e.title,placeholder:e.placeholder,defaultValue:r.arguments[e.id],error:e.err,onChange:e.drop,onBlur:e.validator},a)),(0,l.jsxs)(o.Form.Dropdown,{id:"selectedSound",defaultValue:"default",title:"Sound",children:[(0,l.jsx)(o.Form.Dropdown.Item,{value:"default",title:"Default"}),$.map((e,a)=>(0,l.jsx)(o.Form.Dropdown.Item,{title:e.title,value:e.value,icon:e.icon},a))]}),(0,l.jsx)(o.Form.TextField,{id:"name",title:"Name",placeholder:"Pour Tea",autoFocus:t}),(0,l.jsx)(o.Form.Checkbox,{id:"willBeSaved",label:"Save as preset"})]})}0&&(module.exports={});

"use strict";var w=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var _=Object.getOwnPropertyNames;var M=Object.prototype.hasOwnProperty;var v=(t,o)=>{for(var e in o)w(t,e,{get:o[e],enumerable:!0})},J=(t,o,e,n)=>{if(o&&typeof o=="object"||typeof o=="function")for(let r of _(o))!M.call(t,r)&&r!==e&&w(t,r,{get:()=>o[r],enumerable:!(n=I(o,r))||n.enumerable});return t};var W=t=>J(w({},"__esModule",{value:!0}),t);var U={};v(U,{default:()=>L});module.exports=W(U);var i=require("@raycast/api"),b=require("react");var u=require("@raycast/api"),y=require("react");var p=t=>{let o=Math.floor(t/3600),e=String(Math.floor(t%3600/60)).padStart(2,"0"),n=String(Math.floor(t%60)).padStart(2,"0");return`${o}:${e}:${n}`},C=t=>{let o=[t.getFullYear().toString(),t.getMonth().toString().padStart(2,"0"),t.getDate().toString().padStart(2,"0")],e=[t.getHours(),t.getMinutes(),t.getSeconds()].map(h=>h.toString().padStart(2,"0")),n=o.join("-"),r=e.join(":");return`${n} ${r}`};var l=require("@raycast/api"),D=require("child_process"),f=require("fs"),N=require("path"),F=()=>{let t=[];return(0,f.readdirSync)(l.environment.supportPath).forEach(e=>{if((0,N.extname)(e)==".stopwatch"){let n={name:"",timeStarted:new Date,timeElapsed:-99,originalFile:e};n.name=(0,f.readFileSync)(l.environment.supportPath+"/"+e).toString();let r=e.replace(/__/g,":").replace(".stopwatch","");n.timeStarted=new Date(r),n.timeElapsed=Math.max(0,Math.round(new Date().getTime()-new Date(r).getTime())/1e3),t.push(n)}}),t.sort((e,n)=>e.timeElapsed-n.timeElapsed),t},x=async(t="Untitled")=>{let e=(l.environment.supportPath+"/"+new Date().toISOString()+".stopwatch").replace(/:/g,"__");(0,f.writeFileSync)(e,t),(0,l.popToRoot)(),await(0,l.showHUD)(`Stopwatch "${t}" started! \u{1F389}`)},A=t=>{let o=`if [ -f "${t}" ]; then rm "${t}"; else echo "Timer deleted"; fi`;(0,D.execSync)(o)};function $(){let[t,o]=(0,y.useState)(void 0),[e,n]=(0,y.useState)(t===void 0),r=()=>{let d=F();o(d),n(!1)};return{stopwatches:t,isLoading:e,refreshSWes:r,handleStartSW:()=>{x(),r()},handleStopSW:d=>{(0,u.getPreferenceValues)().copyOnSwStop&&u.Clipboard.copy(p(d.timeElapsed)),o(t?.filter(R=>R.originalFile!==d.originalFile)),A(`${u.environment.supportPath}/${d.originalFile}`),r()}}}var s=require("@raycast/api");var S=require("@raycast/api");var c=require("fs");var g=S.environment.supportPath+"/customTimers.json";function O(t,o){let e=S.environment.supportPath+"/"+t;(0,c.writeFileSync)(e,o)}function k(){(0,c.existsSync)(g)||(0,c.writeFileSync)(g,JSON.stringify({}))}function E(t,o){k();let e=JSON.parse((0,c.readFileSync)(g,"utf8"));e[t].name=o,(0,c.writeFileSync)(g,JSON.stringify(e))}var T=require("react/jsx-runtime");function P(t){let o=e=>{e===""||e===t.currentName?new s.Toast({style:s.Toast.Style.Failure,title:"No new name given!"}).show():((0,s.popToRoot)(),t.originalFile=="customTimer"?E(t.ctID?t.ctID:"-99",e):O(t.originalFile,e),new s.Toast({style:s.Toast.Style.Success,title:`Renamed to ${e}!`}).show())};return(0,T.jsx)(s.Form,{actions:(0,T.jsx)(s.ActionPanel,{children:(0,T.jsx)(s.Action.SubmitForm,{title:"Rename",onSubmit:e=>o(e.newName)})}),children:(0,T.jsx)(s.Form.TextField,{id:"newName",title:"New name",placeholder:t.currentName})})}var a=require("react/jsx-runtime");function L(){let{stopwatches:t,isLoading:o,refreshSWes:e,handleStartSW:n,handleStopSW:r}=$(),{push:h}=(0,i.useNavigation)();return(0,b.useEffect)(()=>{e(),setInterval(()=>{e()},1e3)},[]),(0,a.jsx)(i.List,{isLoading:o,children:(0,a.jsxs)(i.List.Section,{title:t?.length!==0&&t!=null?"Currently Running":"No Stopwatches Running",children:[t?.map(m=>(0,a.jsx)(i.List.Item,{icon:{source:i.Icon.Clock,tintColor:i.Color.Red},title:m.name,subtitle:p(m.timeElapsed)+" elapsed",accessoryTitle:"Started at "+C(m.timeStarted),actions:(0,a.jsxs)(i.ActionPanel,{children:[(0,a.jsx)(i.Action,{title:"Stop Stopwatch",onAction:()=>r(m)}),(0,a.jsx)(i.Action,{title:"Rename Stopwatch",onAction:()=>h((0,a.jsx)(P,{currentName:m.name,originalFile:m.originalFile,ctID:null}))}),(0,a.jsx)(i.Action,{title:"Copy Current Time",shortcut:{modifiers:["opt"],key:"c"},onAction:()=>i.Clipboard.copy(p(m.timeElapsed))})]})},m.originalFile)),(0,a.jsx)(i.List.Item,{icon:i.Icon.Clock,title:"Create a new stopwatch",subtitle:"Press Enter to start a stopwatch",actions:(0,a.jsx)(i.ActionPanel,{children:(0,a.jsx)(i.Action,{title:"Start Stopwatch",onAction:()=>n()})})},0)]})})}0&&(module.exports={});
